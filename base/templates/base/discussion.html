{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>{{ discussion.title }}</title>
    <script src="https://kit.fontawesome.com/a076d05399.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
          integrity="sha512-..." crossorigin="anonymous" referrerpolicy="no-referrer"/>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600&display=swap" rel="stylesheet">
</head>
<style>
    :root {
        --padding-x: clamp(1rem, 5vw, 4rem);
        --max-width: 1280px;
    }

    * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }

    body {
        font-family: 'General Sans', sans-serif;
        background: #fff;
    }

    .dropdown {
        position: relative;
    }

    .dropbtn {
        background: none;
        border: none;
        color: #BFBFBF;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        padding: 0;
    }

    .dropbtn:hover,
    .dropbtn:focus {
        color: #0B304A;
    }

    .dropdown-content {
        display: none;
        position: absolute;
        background-color: white;
        min-width: 160px;
        box-shadow: 0px 8px 16px rgba(0, 0, 0, 0.2);
        z-index: 1000;
        border-radius: 6px;
        margin-top: 10px;
    }

    .dropdown-content a {
        color: black;
        padding: 10px 16px;
        text-decoration: none;
        display: block;
    }

    .dropdown-content a:hover {
        background-color: #f1f1f1;
    }

    .show {
        display: block;
    }

    .navbar {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 1rem var(--padding-x);
        background: #ffffff;
        box-shadow: 0 0.375rem 0.75rem rgba(132, 140, 156, 0.2);
        position: sticky;
        top: 0;
        z-index: 999;
        background-color: white;
        padding: 10px 20px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.1);
    }

    .navbar-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        width: 100%;
        max-width: var(--max-width);
        gap: clamp(1rem, 5vw, 3.5rem);
    }

    .logo {
        font-size: clamp(1.5rem, 2vw, 2rem);
        font-weight: 800;
        font-family: 'Sofia Sans', sans-serif;
        background: linear-gradient(90deg, #FF9EB2, #FAA5FB, #F495FF, #E2D5FF, #8F93FF);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
    }

    .menu {
        display: flex;
        gap: clamp(1rem, 3vw, 2.5rem);
        list-style: none;
    }

    .menu li a {
        text-decoration: none;
        font-size: 1rem;
        font-weight: 600;
        color: #BFBFBF;
        transition: color 0.3s ease;
    }

    .menu li a.active,
    .menu li a:hover {
        color: #0B304A;
    }

    .search {
        display: flex;
        align-items: center;
        border: 2px solid #768694;
        border-radius: 0.25rem;
        padding: 0.5rem 1rem;
        flex-grow: 1;
        max-width: 20rem;
        gap: 0.5rem;
    }

    .search input {
        border: none;
        outline: none;
        font-size: 1rem;
        flex: 1;
        background: transparent;
        color: #768694;
    }

    .search i {
        color: #768694;
    }

    .icons {
        display: flex;
        align-items: center;
        gap: 1rem;
        margin-left: 5%;
    }

    .icons i {
        font-size: 1.25rem;
        color: #0B304A;
        cursor: pointer;
    }

    .avatar-dropdown {
        position: relative;
    }

    .avatar {
        width: 2.5rem;
        height: 2.5rem;
        border-radius: 50%;
        overflow: hidden;
        border: 2px solid #BFBFBF;
    }

    .avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
    }

    .dropdown-menu {
        position: absolute;
        top: 50px;
        right: 0;
        width: 200px;
        background: white;
        border-radius: 12px;
        box-shadow: 0 6px 12px rgba(132, 140, 156, 0.2);
        display: none;
        flex-direction: column;
        padding: 16px 0;
        z-index: 1000;
    }

    .dropdown-menu a {
        padding: 12px 20px;
        display: flex;
        align-items: center;
        gap: 12px;
        text-decoration: none;
        color: #0B304A;
        font-weight: 600;
        font-size: 16px;
        transition: background 0.2s ease;
    }

    .dropdown-menu a:hover {
        background: #F5F6F9;
        border-radius: 8px;
    }

    .show {
        display: flex;
    }


    .circle-arrow-btn {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: #FFFFFF;
        box-shadow: 0px 6px 12px rgba(132, 140, 156, 0.2);
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        padding: 0;
        margin: 2rem 3rem;
    }

    .comment-section {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin: 2rem 0;
        font-family: 'General Sans', sans-serif;
    }

    .comment-section label {
        font-weight: 600;
        color: #0B304A;
        font-size: 1.5rem;
    }

    .comment-section textarea {
        width: 100%;
        min-height: 100px;
        padding: 12px;
        border: 1px solid #E0E0E0;
        border-radius: 6px;
        font-size: 14px;
        font-family: inherit;
        resize: vertical;
        color: #0B304A;
    }

    .comment-section textarea::placeholder {
        color: #BFBFBF;
    }


    .section-heading {
        width: 100%;
        max-width: 920px;
        font-family: 'General Sans', sans-serif;
        font-style: normal;
        font-weight: 600;
        font-size: 1.25rem; /* 20px */
        line-height: 1.1;
        letter-spacing: 0.5px;
        color: #0B304A;

        display: flex;
        align-items: center;
        margin: 0 4rem;
    }

    .post {
        margin: 2vh 3rem;
    }

    .post-card {
        font-family: 'General Sans', sans-serif;
        color: #0B304A;
        width: 65vw;
        padding: 2rem;
        background: #ffffff;
        border: 0.125rem solid #ebecf2;
        border-radius: 0.5rem;
        display: flex;
        flex-direction: column;
        box-sizing: border-box;
        margin: 2vh 0;
    }

    .post-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 0.75rem;
    }

    .user-info {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .avatar {
        width: 2.5rem;
        height: 2.5rem;
        border: 0.0625rem solid #0B304A;
        border-radius: 50%;
        object-fit: cover;
    }

    .username {
        font-weight: 600;
        font-size: 0.9rem;
        letter-spacing: 0.03rem;
    }

    .dots {
        font-size: 1.25rem;
        cursor: pointer;
    }

    .dots svg {
        pointer-events: none;
    }

    .dots-container {
        position: relative;
    }

    .post-content {
        padding-left: clamp(2rem, 4vw, 3rem);
    }

    .post-title {
        font-size: clamp(1.2rem, 2.5vw, 1.5rem);
        font-weight: 600;
        letter-spacing: 0.03rem;
        margin: 0 0 0.5rem;
    }

    .post-text {
        font-size: clamp(0.9rem, 1.5vw, 1rem);
        font-weight: 400;
        letter-spacing: 0.03rem;
        line-height: 1.6;
        margin: 0 0 1rem;
    }

    .post-images {
        display: flex;
        flex-wrap: nowrap; /* отключаем перенос */
        gap: 1rem;
        overflow-x: auto; /* добавляем скролл при необходимости */
        margin-bottom: 1rem;
    }

    .post-images img {
        height: 10rem;
        width: auto;
        border-radius: 0.75rem;
        object-fit: cover;
        flex-shrink: 0; /* чтобы не сжимались */
    }

    .post-images::-webkit-scrollbar {
        display: none; /* Chrome, Safari, Opera */
    }

    .tags {
        display: flex;
        gap: 0.5rem;
        margin-bottom: 1rem;
    }

    .tag {
        background: #EBECF2;
        color: #768694;
        font-size: 0.75rem;
        padding: 0.375rem 0.5rem;
        border-radius: 0.5rem;
    }

    .reactions {
        display: flex;
        gap: 1.75rem;
        align-items: center;
    }

    .reaction {
        display: flex;
        align-items: center;
        gap: 0.25rem;
        font-weight: 600;
        font-size: 0.875rem;
    }

    .reaction svg {
        width: 1.25rem;
        height: 1.25rem;
        color: #0B304A;
    }

    .pagination {
        display: flex;
        gap: 0.5rem;
        align-items: center;
        margin: 2rem 15rem;

    }

    .pagination button {
        background-color: #fff;
        border: none;
        border-radius: 0.75rem;
        padding: 0.5rem 0.85rem;
        font-size: 1rem;
        color: #0B304A;
        cursor: pointer;
        box-shadow: 0 0 0.1rem rgba(0, 0, 0, 0.1);
        transition: all 0.2s ease;
    }

    .pagination button.active {
        background-color: #FF4DC4;
        color: white;
    }

    .pagination .dots {
        padding: 0 0.5rem;
        font-size: 1.2rem;
        color: #0B304A;
    }

    .sidebar-right {
        width: 280px;
        display: flex;
        flex-direction: column;
        gap: 2rem;
        padding: 1.2rem 2rem;
    }

    .sidebar-right h4 {
        font-weight: 600;
        font-size: 1rem;
        color: #0B304A;
        margin-bottom: 1rem;
    }

    .popular-now {
        background: #ffffff;
        border-radius: 12px;
        padding: 20px;
        width: 280px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        border: 1px solid #e5e7eb;
    }

    .popular-now h4 {
        color: #ff4dc4;
        font-size: 1rem;
        font-weight: 700;
        margin-bottom: 16px;
        font-family: 'General Sans', sans-serif;
    }

    .popular-now .tags {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }

    .popular-now .tag {
        background-color: #f1f3f8;
        color: #64748b;
        padding: 6px 12px;
        border-radius: 10px;
        font-size: 14px;
        font-weight: 500;
    }

    .main-container {
        display: flex;
    }

    .recently-viewed {
        background: #ffffff;
        border-radius: 12px;
        padding: 20px;
        width: 280px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.05);
        border: 1px solid #e5e7eb;
    }

    .recently-viewed h4 {
        font-size: 1rem;
        color: #ff50d6;
        font-weight: 700;
        margin-bottom: 1rem;
    }

    .recently-viewed .tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        margin-bottom: 1rem;
    }

    .recently-viewed .tag {
        background: #F1F3F8;
        color: #64748B;
        padding: 0.3rem 0.75rem;
        font-size: 0.85rem;
        border-radius: 8px;
        white-space: nowrap;
    }

    .viewed-card {
        border: 2px solid #0B304A;
        border-radius: 8px;
        padding: 0.75rem;
        margin-bottom: 0.75rem;
        font-size: 0.9rem;
        color: #0B304A;
    }

    .viewed-card a {
        display: block;
        margin-top: 0.5rem;
        font-size: 0.8rem;
        color: #64748B;
        text-decoration: none;
    }

    .answer-title {
        position: absolute;
        width: 76px;
        height: 22px;
        left: 152px;
        font-family: 'General Sans', sans-serif;
        font-style: normal;
        font-weight: 600;
        font-size: 20px;
        line-height: 110%;
        letter-spacing: 0.5px;
        color: #0B304A;
        display: flex;
        align-items: flex-end;
    }

    /* Threaded discussion styles */
    .discussion-container {
        max-width: 800px;
        margin: 0 auto;
        padding: 20px;
    }

    .breadcrumb {
        margin-bottom: 20px;
        font-size: 14px;
        color: #64748B;
    }

    .breadcrumb a {
        color: #0B304A;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    .answer-card, .reply-card {
        background: #fff;
        border: 1px solid #EBECF2;
        border-radius: 8px;
        padding: 16px;
        margin-bottom: 16px;
    }

    .reply-card {
        margin-left: 40px;
        border-left: 3px solid #FF50D6;
    }

    .post-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
    }

    .user-info {
        display: flex;
        align-items: center;
        gap: 8px;
    }

    .user-info .timestamp {
        color: #64748B;
        font-size: 0.8rem;
    }

    .avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        object-fit: cover;
    }

    .username {
        font-weight: 600;
        color: #0B304A;
    }

    .post-actions {
        display: flex;
        gap: 12px;
    }

    .action-btn {
        background: none;
        border: none;
        color: #64748B;
        cursor: pointer;
        font-size: 14px;
        display: flex;
        align-items: center;
        gap: 4px;
    }

    .action-btn:hover {
        color: #0B304A;
    }

    .answer-content {
        margin-left: 40px;
    }

    .answer-tags {
        margin-top: 12px;
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
    }

    .tag {
        background: #F1F2F6;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 12px;
        color: #64748B;
    }

    .answer-meta, .reply-actions {
        margin-top: 12px;
        font-size: 12px;
        color: #64748B;
        display: flex;
        gap: 12px;
    }

    .comment-section {
        margin: 24px 0;
    }

    .comment-section label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: #0B304A;
    }

    .comment-section textarea {
        width: 100%;
        padding: 12px;
        border: 1px solid #EBECF2;
        border-radius: 8px;
        min-height: 100px;
        margin-bottom: 12px;
        font-family: inherit;
    }

    .create-btn {
        background: #FF50D6;
        color: white;
        border: none;
        padding: 8px 16px;
        border-radius: 4px;
        cursor: pointer;
        font-size: 1rem;
    }

    .view-thread {
        color: #FF50D6;
        text-decoration: none;
        font-weight: 500;
    }

    .login-prompt {
        text-align: center;
        padding: 20px;
        background: #F5F6F9;
        border-radius: 8px;
        margin: 20px 0;
    }

    .login-prompt a {
        color: #FF50D6;
        text-decoration: none;
        font-weight: 500;
    }

    .answers-section h3 {
        font-size: 1.2rem;
        color: #0B304A;
        margin: 20px 0 10px;
    }

    .answer-actions {
        display: flex;
        gap: 12px;
        margin-top: 8px;
    }

    .footer {
        background-color: #0B304A;
        padding: 48px 80px 40px;
        margin-top: 50px;
        color: #FFFFFF;
        font-family: 'General Sans', sans-serif;
    }

    .footer-inner {
        max-width: 1280px;
        margin: 0 auto;
    }

    .footer-logo {
        font-size: 32px;
        font-weight: 800;
        font-family: 'Sofia Sans', sans-serif;
        margin-bottom: 36px;
    }

    .footer-grid {
        display: flex;
        flex-wrap: wrap;
        gap: 80px;
        margin-bottom: 40px;
    }

    .footer-column {
        display: flex;
        flex-direction: column;
        gap: 12px;
    }

    .footer-column a {
        color: #FFFFFF;
        text-decoration: none;
        font-weight: 400;
        font-size: 16px;
        letter-spacing: 0.5px;
    }

    .footer-copy {
        color: #EBECF2;
        font-size: 16px;
    }

    .answer-card {
        margin-left: 40px;
        border-left: 3px solid #FF50D6;
        transition: all 0.2s ease;
    }

    .answer-card:hover {
        border-left-width: 5px;
    }

    .reply-card {
        margin-left: 80px;
        border-left: 3px solid #8F93FF;
    }

    .answer-content {
        padding-left: 20px;
    }

    .discussion-container {
        width: 65vw;
        margin: 2vh 0;
    }

    .discussion-card {
        font-family: 'General Sans', sans-serif;
        color: #0B304A;
        padding: 2rem;
        background: #ffffff;
        border: 0.125rem solid #ebecf2;
        border-radius: 0.5rem;
        display: flex;
        flex-direction: column;
        box-sizing: border-box;
        margin-bottom: 1rem;
    }

    .answers-container {
        margin-top: 1rem;
        padding-left: 2rem;
        border-left: 3px solid #F5F6F9;
    }

    .answer-card {
        background: #fff;
        border: 1px solid #EBECF2;
        border-radius: 8px;
        padding: 1.5rem;
        margin-bottom: 1rem;
        border-left: 3px solid #FF50D6;
        transition: all 0.2s ease;
    }

    .answer-card:hover {
        border-left-width: 5px;
        background: #F9FAFB;
    }

    .reply-card {
        margin-left: 2rem;
        border-left: 3px solid #8F93FF;
    }

</style>
<body>
<header>
    <nav class="navbar">
        <div class="navbar-container">
            <svg width="148" height="32" viewBox="0 0 148 32" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path d="M35.7454 2L21.0345 21.389L12.7855 10.5153V28.9968H7V2H12.7855L21.0345 12.8211L29.2836 2H35.7454Z"
                      fill="#0B304A"/>
                <path d="M35.444 29H19.9097L23.8029 23.67H34.2526C36.0047 23.67 37.4239 22.2473 37.4239 20.4952C37.4239 19.6191 37.07 18.8272 36.4953 18.2525C35.9206 17.6778 35.1286 17.3203 34.2526 17.3203H28.439L31.9573 12.502H33.9442C35.4826 12.502 36.7301 11.2545 36.7301 9.7161C36.7301 8.94516 36.4182 8.25132 35.9136 7.74671C35.8225 7.6556 35.7209 7.56799 35.6192 7.4909L38.7661 3.18066C42.7294 4.1969 42.9256 13.4656 38.7661 14.6956C45.8902 16.3532 43.2655 29 35.444 29Z"
                      fill="#FF50D6"/>
                <path d="M63.3592 20.4568H60.6504L59.8935 13.8618L57.3704 19.1287H55.352L52.8289 13.8793L52.0545 20.4568H49.3457L50.7754 8.86475H52.9796L56.3612 16.115L59.6903 8.86475H61.9435L63.3557 20.4568H63.3592Z"
                      fill="#0B304A"/>
                <path d="M64.7051 9.97949C64.7051 9.15599 65.4129 8.53223 66.254 8.53223C67.095 8.53223 67.7678 9.15599 67.7678 9.97949C67.7678 10.803 67.095 11.4267 66.254 11.4267C65.4129 11.4267 64.7051 10.7714 64.7051 9.97949ZM65.0064 20.4572V12.6007H67.4945V20.4572H65.0064Z"
                      fill="#0B304A"/>
                <path d="M77.439 16.234V20.4567H74.9509V16.3847C74.9509 15.1723 74.2115 14.7027 73.5878 14.7027C72.915 14.7027 72.0739 15.0566 72.0739 16.3672V20.4567H69.5859V12.6001H72.0739V13.9633C72.3753 12.8875 73.6053 12.4004 74.3272 12.4004C76.4122 12.4004 77.439 13.8301 77.439 16.2375V16.234Z"
                      fill="#0B304A"/>
                <path d="M85.2259 8.3287H87.7V20.4569H85.2259V19.5809C84.6547 20.3378 83.593 20.6567 82.787 20.6567C80.8351 20.6567 78.9849 19.0587 78.9849 16.5181C78.9849 13.9776 80.8351 12.3971 82.787 12.3971C83.593 12.3971 84.6547 12.716 85.2259 13.4554V8.3252V8.3287ZM85.1243 16.5216C85.1243 15.5124 84.2658 14.7064 83.3231 14.7064C82.3805 14.7064 81.5079 15.5299 81.5079 16.5216C81.5079 17.5133 82.3489 18.3544 83.3231 18.3544C84.2973 18.3544 85.1243 17.5309 85.1243 16.5216Z"
                      fill="#0B304A"/>
                <path d="M98.8505 17.1278C98.8505 18.7082 97.8238 20.4568 95.0975 20.4568H90.0688V8.86475H94.761C96.8811 8.86475 98.2443 10.1438 98.2443 11.8574C98.2443 12.6634 97.9429 13.8758 96.6113 14.2648C98.1427 14.4821 98.847 15.7962 98.847 17.1243L98.8505 17.1278ZM94.5788 11.1741H92.7111V13.3957H94.5613C95.1851 13.3957 95.6056 12.9928 95.6056 12.2849C95.6056 11.6962 95.3042 11.1741 94.5788 11.1741ZM94.7786 18.1545C95.7212 18.1545 96.1908 17.5167 96.1908 16.8579C96.1908 16.2517 95.7703 15.5614 94.7786 15.5614H92.7111V18.151H94.7786V18.1545Z"
                      fill="#0B304A"/>
                <path d="M106.437 12.6352L105.848 15.0076C105.361 14.7202 104.972 14.7062 104.719 14.7062C103.745 14.7062 102.936 15.5297 102.936 17.853V20.4602H100.448V12.6036H102.904V14.2682C103.36 12.9716 104.299 12.4004 105.259 12.4004C105.631 12.4004 106.034 12.4354 106.437 12.6352Z"
                      fill="#0B304A"/>
                <path d="M107.225 9.97949C107.225 9.15599 107.933 8.53223 108.774 8.53223C109.615 8.53223 110.288 9.15599 110.288 9.97949C110.288 10.803 109.615 11.4267 108.774 11.4267C107.933 11.4267 107.225 10.7714 107.225 9.97949ZM107.53 20.4572V12.6007H110.018V20.4572H107.53Z"
                      fill="#0B304A"/>
                <path d="M117.906 8.3287H120.38V20.4569H117.906V19.5809C117.335 20.3378 116.273 20.6567 115.467 20.6567C113.515 20.6567 111.665 19.0587 111.665 16.5181C111.665 13.9776 113.515 12.3971 115.467 12.3971C116.273 12.3971 117.335 12.716 117.906 13.4554V8.3252V8.3287ZM117.808 16.5216C117.808 15.5124 116.949 14.7064 116.007 14.7064C115.064 14.7064 114.192 15.5299 114.192 16.5216C114.192 17.5133 115.033 18.3544 116.007 18.3544C116.981 18.3544 117.808 17.5309 117.808 16.5216Z"
                      fill="#0B304A"/>
                <path d="M128.268 12.6035H130.742V19.5174C130.742 22.8465 128.994 24.532 126.148 24.532C124.365 24.532 122.851 23.4878 122.23 22.009L124.284 21.1855C124.571 21.8232 125.328 22.3454 126.152 22.3454C127.448 22.3454 128.272 21.6235 128.272 19.8223V19.5875C127.683 20.3269 126.639 20.6633 125.833 20.6633C123.881 20.6633 122.031 19.0654 122.031 16.5248C122.031 13.9842 123.881 12.4038 125.833 12.4038C126.639 12.4038 127.683 12.7227 128.272 13.4621V12.6035H128.268ZM128.167 16.5213C128.167 15.5121 127.308 14.7061 126.366 14.7061C125.423 14.7061 124.55 15.5296 124.55 16.5213C124.55 17.513 125.391 18.354 126.366 18.354C127.34 18.354 128.167 17.5305 128.167 16.5213Z"
                      fill="#0B304A"/>
                <path d="M140.715 17.2608H134.961C135.196 18.0177 135.851 18.4873 136.794 18.4873C137.533 18.4873 138.29 18.1509 138.777 17.6813L140.056 19.2968C139.282 20.1378 137.936 20.6599 136.625 20.6599C134.137 20.6599 132.385 18.9428 132.385 16.5564C132.385 13.9983 134.355 12.4004 136.608 12.4004C138.861 12.4004 140.746 13.9808 140.746 16.3707C140.746 16.588 140.729 16.8753 140.711 17.2608H140.715ZM138.276 15.7995C138.241 15.0251 137.554 14.5029 136.66 14.5029C135.921 14.5029 135.196 14.8569 134.943 15.7995H138.272H138.276Z"
                      fill="#0B304A"/>
            </svg>
            <ul class="menu">
                <li><a href="{% url 'base:home' %}">Home</a></li>
                <li><a href="{% url 'base:discussions' %}">Discussions</a></li>
                <li class="dropdown">
                    <button onclick="toggleDropdown()" class="dropbtn">Library</button>
                    <div class="dropdown-content" id="libraryDropdown">
                        <a href="{% url 'library' %}" class="active">Library Home</a>
                        <a href="{% url 'filter_articles' %}"
                           class="tag {% if current_filter == 'article' %}active{% endif %}">Library Book</a>
                        <a href="{% url 'filter_videos' %}"
                           class="tag {% if current_filter == 'video' %}active{% endif %}">Library Videos</a>
                    </div>
                </li>
                <li><a href="{% url 'careers:vacancy_list' %}">Career</a></li>
            </ul>
            <div class="search">
                <i class="fas fa-search"></i>
                <input type="text" id="searchInput" placeholder="Search for..." onkeyup="filterContent()"/>
            </div>
            <div class="icons">
                <a href="{% url 'base:saved-discussions' %}"><i class="fa-regular fa-bookmark"></i></a>
                {% if user.is_staff %}
                    <a href="{% url 'base:reported-discussions' %}"><i class="fa-solid fa-flag"></i></a>
                {% endif %}
                <div class="avatar-dropdown">
                    {% if request.user.profile.avatar %}
                        <div class="avatar" onclick="toggleMenu()">
                            <img src="{{ request.user.profile.avatar.url }}" alt="missing profile picture"/>
                        </div>
                    {% else %}
                        <div class="avatar" onclick="toggleMenu()">
                            <img src="{% static 'icons/no_avatar.jpg' %}" alt="missing profile picture"/>
                        </div>
                    {% endif %}
                    <div class="dropdown-menu" id="profileMenu">
                        <a href="{% url 'base:user-profile' request.user.id %}"><i class="fa-regular fa-user"></i>
                            Profile</a>
                        <a href="{% url 'base:edit-profile' request.user.id %}"><i class="fa-solid fa-pen"></i> Edit</a>
                        <a href="{% url 'base:saved-discussions' %}"><i class="fa-regular fa-bookmark"></i> Saved</a>
                        {% if user.is_staff %}
                            <a href="{% url 'admin:index' %}"><i class="fa-regular fa-hammer"></i>Admin panel</a>
                        {% endif %}
                        <a href="{% url 'auth:logout' %}"><i class="fa-solid fa-right-from-bracket"></i> Log out</a>
                    </div>
                </div>
            </div>
        </div>
    </nav>
</header>
<a href={% url 'base:home' %} class="circle-arrow-btn">
    <svg width="26" height="24" viewBox="0 0 26 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M24.1426 12L1.85687 12" stroke="#0B304A" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round"/>
        <path d="M7.85742 18L1.85742 12L7.85742 6" stroke="#0B304A" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round"/>
    </svg>
    <h3 class="answer-title">Answer</h3>
</a>
<div class="main-container">
    <div class="post">
        <div class="post-card">
            <div class="post-header">
                <div class="user-info">
                    {% if discussion.host.profile.avatar %}
                        <div class="avatar" onclick="toggleMenu()">
                            <a href="{% url 'base:user-profile' request.user.id %}">
                                <img src="{{ discussion.host.profile.avatar.url }}" alt="missing profile picture"/>
                            </a>
                        </div>
                    {% else %}
                        <div class="avatar" onclick="toggleMenu()">
                            <a href="{% url 'base:user-profile' request.user.id %}">
                                <img src="{% static 'icons/no_avatar.jpg' %}" alt="missing profile picture"/>
                            </a>
                        </div>
                    {% endif %}
                    <a href="{% url 'base:user-profile' request.user.id %}"
                       style="text-decoration: none; color: #0B304A;">
                        <span class="username">{{ discussion.host.username }}</span>
                    </a>

                </div>
                <div class="dots-container">
                    <div class="dots" onclick="togglePostMenu(this)">
                        <svg width="14" height="14" viewBox="0 0 14 14" fill="none"
                             xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 8.5C12.8284 8.5 13.5 7.82843 13.5 7C13.5 6.17157 12.8284 5.5 12 5.5C11.1716 5.5 10.5 6.17157 10.5 7C10.5 7.82843 11.1716 8.5 12 8.5Z"
                                  fill="#0B304A"/>
                            <path d="M7 8.5C7.82843 8.5 8.5 7.82843 8.5 7C8.5 6.17157 7.82843 5.5 7 5.5C6.17157 5.5 5.5 6.17157 5.5 7C5.5 7.82843 6.17157 8.5 7 8.5Z"
                                  fill="#0B304A"/>
                            <path d="M2 8.5C2.82843 8.5 3.5 7.82843 3.5 7C3.5 6.17157 2.82843 5.5 2 5.5C1.17157 5.5 0.5 6.17157 0.5 7C0.5 7.82843 1.17157 8.5 2 8.5Z"
                                  fill="#0B304A"/>
                        </svg>
                    </div>
                    <div class="post-dropdown-menu">
                        {% if request.user == discussion.host %}
                            <a href="{% url 'base:update-discussion' discussion.id %}">
                                <i class="fa-solid fa-pen"></i> Edit
                            </a>
                            <a href="{% url 'base:delete-discussion' discussion.id %}" class="delete-btn">
                                <i class="fa-solid fa-trash"></i> Delete
                            </a>
                            <a href="#" class="save-btn" data-discussion-id="{{ discussion.id }}">
                                <i class="fa-regular fa-bookmark"></i>
                                <span class="save-text">
                                        {% if request.user in discussion.saved_by.all %}Unsave{% else %}Save{% endif %}
                                    </span>
                            </a>
                        {% else %}
                            <a href="#" class="save-btn" data-discussion-id="{{ discussion.id }}">
                                <i class="fa-regular fa-bookmark"></i>
                                <span class="save-text">
                                        {% if request.user in discussion.saved_by.all %}Unsave{% else %}Save{% endif %}
                                    </span>
                            </a>
                            <a href="#" class="report-btn" data-discussion-id="{{ discussion.id }}">
                                <i class="fa-solid fa-flag"></i> Report
                            </a>
                        {% endif %}
                    </div>

                    <div id="reportModal" class="modal">
                        <div class="modal-content">
                            <span class="close">&times;</span>
                            <h3>Report Discussion</h3>
                            <form id="reportForm">
                                <input type="hidden" id="reportDiscussionId" value="">
                                <textarea id="reportReason"
                                          placeholder="Please explain the reason for reporting..."
                                          required></textarea>
                                <div id="reportError" style="color: red; display: none;"></div>
                                <button type="submit">Submit Report</button>
                            </form>
                        </div>
                    </div>

                    <style>
                        .modal {
                            display: none;
                            position: fixed;
                            z-index: 1000;
                            left: 0;
                            top: 0;
                            width: 100%;
                            height: 100%;
                            background-color: rgba(0, 0, 0, 0.4);
                        }

                        .modal-content {
                            background-color: #fff;
                            margin: 15% auto;
                            padding: 20px;
                            border-radius: 8px;
                            width: 400px;
                            max-width: 90%;
                        }

                        .modal-content h3 {
                            margin-top: 0;
                            color: #0B304A;
                        }

                        .modal-content textarea {
                            width: 100%;
                            height: 120px;
                            padding: 10px;
                            margin: 10px 0;
                            border: 1px solid #ddd;
                            border-radius: 4px;
                            resize: vertical;
                        }

                        .modal-content button {
                            background-color: #FF42C2;
                            color: white;
                            border: none;
                            padding: 8px 16px;
                            border-radius: 4px;
                            cursor: pointer;
                            font-size: 1rem;
                        }

                        .close {
                            color: #aaa;
                            float: right;
                            font-size: 28px;
                            font-weight: bold;
                            cursor: pointer;
                        }

                        .close:hover {
                            color: #000;
                        }
                    </style>
                </div>
            </div>
            <div class="post-content">
                <h2 class="post-title">{{ discussion.title }}</h2>
                <p class="post-text">
                    {{ discussion.content }}
                </p>


                <div class="tags">
                    {% for tag in discussion.tags.all %}
                        <span class="tag">#{{ tag }}</span>
                    {% endfor %}
                </div>

                <div class="reactions">
                    <div class="reaction">
                        <svg width="22" height="22" viewBox="0 0 22 22" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M5.99944 11.7142C6.39393 11.7142 6.71373 11.3944 6.71373 10.9999C6.71373 10.6054 6.39393 10.2856 5.99944 10.2856C5.60495 10.2856 5.28516 10.6054 5.28516 10.9999C5.28516 11.3944 5.60495 11.7142 5.99944 11.7142Z"
                                  stroke="#0B304A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M10.642 11.7142C11.0365 11.7142 11.3563 11.3944 11.3563 10.9999C11.3563 10.6054 11.0365 10.2856 10.642 10.2856C10.2475 10.2856 9.92773 10.6054 9.92773 10.9999C9.92773 11.3944 10.2475 11.7142 10.642 11.7142Z"
                                  stroke="#0B304A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M15.2856 11.7142C15.6801 11.7142 15.9999 11.3944 15.9999 10.9999C15.9999 10.6054 15.6801 10.2856 15.2856 10.2856C14.8911 10.2856 14.5713 10.6054 14.5713 10.9999C14.5713 11.3944 14.8911 11.7142 15.2856 11.7142Z"
                                  stroke="#0B304A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            <path d="M10.9996 1.71436C9.31993 1.71488 7.67186 2.17098 6.23093 3.03409C4.78999 3.8972 3.61015 5.13498 2.81706 6.61561C2.02397 8.09623 1.64734 9.76425 1.72728 11.442C1.80722 13.1198 2.34074 14.7444 3.27101 16.1429L1.71387 20.2858L6.92815 19.3429C8.18374 19.9565 9.56161 20.2787 10.9591 20.2857C12.3565 20.2926 13.7375 19.984 14.9991 19.3829C16.2607 18.7818 17.3704 17.9037 18.2454 16.814C19.1204 15.7244 19.7381 14.4513 20.0526 13.0897C20.3671 11.728 20.3702 10.313 20.0616 8.94997C19.7531 7.58697 19.1409 6.31119 18.2707 5.21774C17.4004 4.12428 16.2946 3.24134 15.0357 2.63474C13.7767 2.02814 12.3971 1.71353 10.9996 1.71436V1.71436Z"
                                  stroke="#0B304A" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        </svg>
                        <span>{{ answer_count }}</span></div>
                </div>
            </div>
        </div>
        <div class="comment-section">
            <form method="POST" action="{% url 'base:create-answer' %}">
                {% csrf_token %}
                <input type="hidden" name="discussion_id" value="{{ discussion_id }}">
                <label for="comment">Comment</label>
                <textarea id="comment" name='comment' placeholder="I think Universities are overrated"></textarea>
                <button type="submit" class="create-btn">Post comment</button>
            </form>
        </div>

        <div class="answers-section">
            <h3>Answers</h3>

            {% for answer in answers %}
                <div class="answer-card">
                    <div class="post-header">
                        <div class="user-info">
                            {% if answer.user.profile.avatar %}
                                <img src="{{ answer.user.profile.avatar.url }}" class="avatar" alt="User avatar">
                            {% else %}
                                <img src="{% static 'icons/no_avatar.jpg' %}" class="avatar" alt="Default avatar">
                            {% endif %}
                            <span class="username">{{ answer.user.username }}</span>
                            <span class="timestamp">{{ answer.created_at|timesince }} ago</span>
                        </div>
                        <div class="dots-container">
                            <div class="dots" onclick="togglePostMenu(this)">
                                <svg width="14" height="14" viewBox="0 0 14 14" fill="none"
                                     xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 8.5C12.8284 8.5 13.5 7.82843 13.5 7C13.5 6.17157 12.8284 5.5 12 5.5C11.1716 5.5 10.5 6.17157 10.5 7C10.5 7.82843 11.1716 8.5 12 8.5Z"
                                          fill="#0B304A"/>
                                    <path d="M7 8.5C7.82843 8.5 8.5 7.82843 8.5 7C8.5 6.17157 7.82843 5.5 7 5.5C6.17157 5.5 5.5 6.17157 5.5 7C5.5 7.82843 6.17157 8.5 7 8.5Z"
                                          fill="#0B304A"/>
                                    <path d="M2 8.5C2.82843 8.5 3.5 7.82843 3.5 7C3.5 6.17157 2.82843 5.5 2 5.5C1.17157 5.5 0.5 6.17157 0.5 7C0.5 7.82843 1.17157 8.5 2 8.5Z"
                                          fill="#0B304A"/>
                                </svg>
                            </div>
                            <div class="post-dropdown-menu">
                                {% if request.user == answer.user %}
                                    <a href="#" class="edit-answer" data-answer-id="{{ answer.id }}">
                                        <i class="fa-solid fa-pen"></i> Edit
                                    </a>
                                    <a href="#" class="delete-answer" data-answer-id="{{ answer.id }}">
                                        <i class="fa-solid fa-trash"></i> Delete
                                    </a>
                                {% endif %}
                                <a href="#" class="save-btn" data-answer-id="{{ answer.id }}">
                                    <i class="fa-regular fa-bookmark"></i>
                                    <span class="save-text">
                                {% if request.user in answer.saved_by.all %}Saved{% else %}Save{% endif %}
                            </span>
                                </a>
                                {% if request.user != answer.user %}
                                    <a href="#" class="report-btn" data-answer-id="{{ answer.id }}">
                                        <i class="fa-solid fa-flag"></i> Report
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <div class="answer-content">
                        <p>{{ answer.content }}</p>

                        <div class="answer-actions">
                            <a href="{% url 'base:answer-discussion' answer.id %}" class="view-thread">
                                View thread ({{ answer.replies.count }} replies)
                            </a>
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

    </div>
    <div class="sidebar-right">
        <div class="popular-now">
            <h4>Popular now</h4>
            <div class="tags">
                {#                <span class="tag">#design</span>#}
                {% for tag in popular_tags %}
                    <a href="{% url 'base:tagged' tag.slug %}" class="tag">#{{ tag.name }}</a>
                    <span>#{{ tag.name }}</span>
                {% endfor %}
            </div>
        </div>
        <div class="recently-viewed">
            <h4>Recently viewed</h4>
            <div class="tags">
                {% for recent_viewed_discussion in recently_viewed_discussions %}
                    <a href="{% url 'base:discussion' pk=recent_viewed_discussion.id %}"
                       class="tag">{{ recent_viewed_discussion.title }}</a>
                {% endfor %}

                {% for recent_viewed_discussion in recently_viewed_discussions %}
                    <div class="viewed-card">
                        <p>{{ recent_viewed_discussion.content|truncatewords:20 }}</p>
                        <a href="{% url 'base:discussion' pk=recent_viewed_discussion.id %}">View more…</a>
                    </div>
                {% endfor %}

            </div>
        </div>
    </div>
</div>

<script>
    function openModal(src) {
        const modal = document.getElementById('modal');
        const modalImg = document.getElementById('/library/post.png');
        modal.style.display = 'flex';
        modalImg.src = src;
    }

    function closeModal() {
        document.getElementById('modal').style.display = 'none';
    }

    function toggleDropdown() {
        document.getElementById("libraryDropdown").classList.toggle("show");
    }

    function togglePostMenu(element) {
        // Close all other open menus first
        document.querySelectorAll('.post-dropdown-menu').forEach(menu => {
            if (menu !== element.nextElementSibling) {
                menu.classList.remove('show');
            }
        });

        // Toggle the clicked menu
        const menu = element.nextElementSibling;
        menu.classList.toggle('show');

        // Close when clicking outside
        const clickHandler = function (e) {
            if (!menu.contains(e.target) && e.target !== element) {
                menu.classList.remove('show');
                document.removeEventListener('click', clickHandler);
            }
        };

        document.addEventListener('click', clickHandler);
    }


    window.onclick = function (event) {
        if (!event.target.matches('.dropbtn')) {
            const dropdowns = document.getElementsByClassName("dropdown-content");
            for (let i = 0; i < dropdowns.length; i++) {
                dropdowns[i].classList.remove('show');
            }
        }
    }

    function filterContent() {
        const input = document.getElementById('searchInput');
        const filter = input.value.toLowerCase();
        const cards = document.querySelectorAll('.post-card');

        cards.forEach(function (card) {
            const text = card.textContent.toLowerCase();
            card.style.display = text.includes(filter) ? 'block' : 'none';
        });
    }

    function toggleMenu() {
        document.getElementById("profileMenu").classList.toggle("show");
    }

    window.onclick = function (event) {
        if (!event.target.closest('.avatar-dropdown')) {
            document.getElementById("profileMenu").classList.remove("show");
        }
    }
</script>
</body>
<footer class="footer">
    <div class="footer-inner">
        <h2 class="footer-logo">MindBridge</h2>
        <div class="footer-grid">
            <div class="footer-column">
                <a href="home2.html">Home</a>
                <a href="MainCareer.html">Career</a>
                <a href="discussionpage.html">Discussions</a>
            </div>
            <div class="footer-column">
                <a href="library_main.html">Articles</a>
                <a href="library-view.html">Videos</a>
                <a href="library-book.html">Books</a>
            </div>
            <div class="footer-column">
                <a href="welcome.html">About</a>
            </div>
        </div>
        <p class="footer-copy">2025 MindBridge</p>
    </div>
</footer>
</html>