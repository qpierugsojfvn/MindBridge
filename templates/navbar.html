{% load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href={% static 'base/home.css' %}>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM" crossorigin="anonymous">
    <title>Home MindBridge</title>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <a href="{% url 'home' %}">
                    <img alt="logo" src={% static 'logo/Asset 8.png' %}>
                </a>
            </div>
            <ul class="nav-links">
                <li><a href="/">Home</a></li>
                <li><a href="/">Discussions</a></li>
                <li><a href={% url 'library' %}>Library</a></li>
                <li><a href={% url 'careers:job_list' %}>Career</a></li>
            </ul>
{#            <input type="text" class="search-bar" placeholder="Search for...">#}
            <form method="GET" action="{% url 'home' %}">
                <label for="search-bar"></label>
                <input id="search-bar" type="text" name="q" class="search-bar" placeholder="{% if '/library/' in request.path %}Search lessons...{% elif '/career/' in request.path %}Search vacancies...{% else %} Search discussions...{% endif %}">
            </form>
            <div class="icons">
                <i class="bi bi-bell"></i>
                <i class="bi bi-chat"></i>
                {% if request.user.is_authenticated %}
                    {# profile photo #}
{#                    <i class="bi bi-person"><a  href={% url 'user-profile' pk=user.id %}></a></i>#}
                    <a  href={% url 'user-profile' pk=user.id %}><i class="bi bi-person"></i></a>
                    Hello, {{ request.user.username }}!
                    <a href={% url 'logout' %}><i class="bi bi-door-open"></i></a>

                {% else %}
                    <a href={% url 'login' %}><i class="bi bi-person"></i></a>
                {% endif %}
            </div>
        </nav>
    </header>

    <script>
        let posts = [
            {
                id: 1,
                user: "Lianna Limm",
                avatar: "/library/ava.png",
                image: [""],
                text: "Title PWA application",
                hashtags: ["design", "ais","ais_krasivaya"],
                likes: 0,
                dislikes: 0,
                comments: ["Wow, amazing!", "–ê–π—Å —Ç—ã –º–æ–ª–æ–¥–µ—Ü—Ü"]
            },
        ];
    //–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ—Å—Ç
        function renderPosts(filterTag = null) {
            $("#posts-container").empty();
            posts.forEach(post => {
                if (filterTag && !post.hashtags.includes(filterTag)) return;

                let hashtagsHtml = post.hashtags.map(tag => `<span class="tags" data-tag="${tag}">#${tag}</span>`).join(" ");
                let commentsHtml = post.comments.map(comment => `<p class="small">${comment}</p>`).join("");

                let postHtml = `
                    <div class="card">
                        <div class="card-header d-flex align-items-center">
                            <img src="${post.avatar}" class="rounded-circle me-2" width="40">
                            <strong>${post.user}</strong>
                        </div>
                        <img src="${post.image}" class="card-img-top">
                        <div class="card-body">
                            <p>${post.text}</p>
                            <div>${hashtagsHtml}</div>
                            <div class="post-actions mt-2">
                                <span class="like-btn" data-id="${post.id}">‚ù§Ô∏è ${post.likes}</span>
                                <span class="dislike-btn" data-id="${post.id}">üëé ${post.dislikes}</span>
                                <span class="comment-toggle" data-id="${post.id}">üí¨ Comments</span>
                            </div>
                            <div class="comments mt-2" id="comments-${post.id}">
                                ${commentsHtml}
                                <input type="text" class="form-control comment-input" data-id="${post.id}" placeholder="Add a comment...">
                            </div>
                        </div>
                    </div>
                `;
                $("#posts-container").append(postHtml);
            });
        }

        $(document).ready(function() {
            renderPosts();

      //–ª–∞–π–∫ –¥–∏–∑–ª–∞–π–∫ –∞–Ω–∞—É –º—ã–Ω–∞—É
            $(document).on("click", ".like-btn", function() {
                let postId = $(this).data("id");
                posts = posts.map(post => post.id === postId ? { ...post, likes: post.likes + 1 } : post);
                renderPosts();
            });

            $(document).on("click", ".dislike-btn", function() {
                let postId = $(this).data("id");
                posts = posts.map(post => post.id === postId ? { ...post, dislikes: post.dislikes + 1 } : post);
                renderPosts();
            });


            $(document).on("click", ".comment-toggle", function() {
            let postId = $(this).data("id");
            $(`#comments-${postId}`).toggle();
        });
//–∫–æ–º–º–µ–Ω—Ç—ã
        $(document).on("keypress", ".comment-input", function(event) {
            if (event.which === 13) {
                let postId = $(this).data("id");
                let commentText = $(this).val().trim();
                if (commentText) {
                    posts = posts.map(post => post.id === postId ? { ...post, comments: [...post.comments, commentText] } : post);
                    renderPosts();
                }
            }
        });


 //—Ñ–∏–ª—å—Ç—Ä —Ö—ç—à—Ç–µ–≥–ø–µ–Ω
            $(document).on("click", ".tags", function() {
                let tag = $(this).data("tag");
                $("#filter-tag").text(`#${tag}`);
                $("#clear-filter").removeClass("d-none");
                renderPosts(tag);
            });

            $("#clear-filter").click(function() {
                $("#filter-tag").text("");
                $(this).addClass("d-none");
                renderPosts();
            });

        });
    </script>
</body>
</html>



{#{% load static %}#}
{#<a href="/">#}
{#    <h1>LOGO</h1>#}
{#</a>#}
{##}
{##}
{##}
{#<form method="GET" action="{% url 'home' %}">#}
{#    <input type="text" name="q" placeholder="Search discussions...">#}
{#</form>#}
{##}
{#{% if request.user.is_authenticated %}#}
{#    <p>Hello, {{ request.user }}</p>#}
{#<a href="{% url 'logout' %}">Logout</a>#}
{#{% else %}#}
{#<a href="{% url 'login' %}">Login</a>#}
{#{% endif %}#}
{##}
{#<hr>#}